/*
 * Wunderlist-api v0.1.0
 * https://github.com/felipesousa/wunderlist-api
 *
 * MIT license @ 2016 Felipe Sousa
 * https://github.com/felipesousa/wunderlist-api/blob/master/LICENSE
 *
 * Date: 2016-03-16
 */
var request=require("request"),_=require("underscore"),keys={},q=require("q");exports.authentication=function(e,t){return keys={headers:{"X-Access-Token":e,"X-Client-ID":t,"Content-Type":"application/json"}}},exports.getLists=function(){var e=q.defer(),t={url:"https://a.wunderlist.com/api/v1/lists",method:"GET"},r=_.extend(t,keys);return request(r,function(t,r,s){t&&e.reject(t),r&&e.resolve(r)}),e.promise},exports.getOneList=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/lists/"+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.createList=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/lists",method:"POST",json:{title:e}},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.updateList=function(e,t,r){var s=q.defer();if(!_.isNumber(arguments[1]))throw new Error("Argument REVISION require type Number.");var o={url:"https://a.wunderlist.com/api/v1/lists/"+e,method:"PATCH",json:{revision:t,title:r}},n=_.extend(o,keys);return request(n,function(e,t,r){e&&s.reject(e),t&&s.resolve(t)}),s.promise},exports.stateList=function(e,t,r){var s=q.defer();if(!_.isNumber(arguments[1]))throw new Error("Argument REVISION require type Number.");var o={url:"https://a.wunderlist.com/api/v1/lists/"+e,method:"PATCH",json:{revision:t,"public":r}},n=_.extend(o,keys);return request(n,function(e,t,r){e&&s.reject(e),t&&s.resolve(t)}),s.promise},exports.deleteList=function(e,t){var r=q.defer();if(!_.isNumber(arguments[1]))throw new Error("Argument REVISION require type Number.");var s={url:"https://a.wunderlist.com/api/v1/lists/"+e+"?revision="+t,method:"DELETE"},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.listUsers=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/users",method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.getAllTasks=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/tasks?list_id="+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.getTasksForState=function(e,t){var r=q.defer(),s={url:"https://a.wunderlist.com/api/v1/tasks?list_id="+e+"&completed="+t,method:"GET"},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.getOneTask=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/tasks/"+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.createTask=function(e,t,r,s){var o=q.defer(),n={url:"https://a.wunderlist.com/api/v1/tasks",method:"POST",json:{list_id:e,title:t,completed:r,starred:s}},i=_.extend(n,keys);return request(i,function(e,t,r){e&&o.reject(e),t&&o.resolve(t)}),o.promise},exports.deleteTask=function(e,t){var r=q.defer(),s={url:"https://a.wunderlist.com/api/v1/tasks/"+e+"?revision="+t,method:"DELETE"},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.user=function(){var e=q.defer(),t={url:"https://a.wunderlist.com/api/v1/user",method:"GET"},r=_.extend(t,keys);return request(r,function(t,r,s){t&&e.reject(t),r&&e.resolve(r)}),e.promise},exports.avatar=function(e,t,r){var s={headers:{"Content-Type":"image/png"}},o=q.defer(),n={url:"https://a.wunderlist.com/api/v1/avatar?user_id="+e+"&size="+t+"&fallback="+r,method:"GET"},i=_.extend(n,s);return request(i,function(e,t,r){e&&o.reject(e),t&&o.resolve(t.request.href)}),o.promise},exports.getMembership=function(){var e=q.defer(),t={url:"https://a.wunderlist.com/api/v1/memberships",method:"GET"},r=_.extend(t,keys);return request(r,function(t,r,s){t&&e.reject(t),r&&e.resolve(r)}),e.promise},exports.addMemberToList=function(e,t,r){var s=q.defer(),o={url:"https://a.wunderlist.com/api/v1/memberships",method:"POST",json:{list_id:t,user_id:e,muted:r}},n=_.extend(o,keys);return request(n,function(e,t,r){e&&s.reject(e),t&&s.resolve(t)}),s.promise},exports.removeMember=function(e,t){var r=q.defer(),s={url:"https://a.wunderlist.com/api/v1/memberships/"+e,method:"DELETE",json:{revision:t}},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.getCommentsList=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/task_comments?list_id="+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.getCommentsTask=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/task_comments?task_id="+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.createComment=function(e,t){var r=q.defer(),s={url:"https://a.wunderlist.com/api/v1/task_comments",method:"POST",json:{task_id:e,text:t}},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.getSubtaskFromList=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/subtasks?list_id="+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.getSubtaskFromTask=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/subtasks?task_id="+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.getSubtaskCompletedFromList=function(e,t){var r=q.defer(),s={url:"https://a.wunderlist.com/api/v1/subtasks?list_id="+e+"&completed="+t,method:"GET"},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.getSubtaskCompletedFromTask=function(e,t){var r=q.defer(),s={url:"https://a.wunderlist.com/api/v1/subtasks?task_id="+e+"&completed="+t,method:"GET"},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.createSubstask=function(e,t,r){var s=q.defer(),o={url:"https://a.wunderlist.com/api/v1/subtasks",method:"POST",json:{task_id:e,title:t,completed:r}},n=_.extend(o,keys);return request(n,function(e,t,r){e&&s.reject(e),t&&s.resolve(t)}),s.promise},exports.deleteSubtask=function(e,t){var r=q.defer();if(!_.isNumber(arguments[1]))throw new Error("Argument REVISION require type Number.");var s={url:"https://a.wunderlist.com/api/v1/subtasks/"+e+"?revision="+t,method:"DELETE"},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.getNoteFromList=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/notes?list_id="+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.getNoteFromTask=function(e){var t=q.defer(),r={url:"https://a.wunderlist.com/api/v1/notes?task_id="+e,method:"GET"},s=_.extend(r,keys);return request(s,function(e,r,s){e&&t.reject(e),r&&t.resolve(r)}),t.promise},exports.createNote=function(e,t){var r=q.defer(),s={url:"https://a.wunderlist.com/api/v1/notes",method:"POST",json:{task_id:e,content:t}},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise},exports.deleteNote=function(e,t){var r=q.defer(),s={url:"https://a.wunderlist.com/api/v1/notes/"+e+"?revision="+t,method:"DELETE"},o=_.extend(s,keys);return request(o,function(e,t,s){e&&r.reject(e),t&&r.resolve(t)}),r.promise};